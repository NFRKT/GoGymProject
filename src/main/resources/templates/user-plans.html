    <!DOCTYPE html>
    <html xmlns:th="http://www.thymeleaf.org">

    <head>
        <title>Moje Plany Treningowe</title>
        <style>
        .body {
          font-family: Arial, sans-serif;
          margin: 20px;
        }

        .plan {
        display: block;
        }

        .plans-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
          gap: 20px;
        }

        .plan-panel {
          border: 1px solid #ccc;
          border-radius: 10px;
          padding: 20px;
          background-color: #f9f9f9;
          cursor: pointer;
          text-align: center;
        }

        .plan-panel h3 {
          color: #333;
        }

        /* Modal */
        .modal {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          justify-content: center;
          align-items: center;
        }

        .modal-content {
          background: white;
          padding: 20px;
          border-radius: 10px;
          width: 80%;
          max-height: 80%;
          overflow-y: auto;
        }

        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          border-bottom: 1px solid #ddd;
          margin-bottom: 20px;
        }

        .modal-header h3 {
          margin: 0;
        }

        .close-modal {
          cursor: pointer;
          font-size: 20px;
          color: red;
        }

        .exercise {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin: 10px 0;
        }

        .exercise button {
          padding: 5px 10px;
          font-size: 14px;
        }

    .status-icon {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-circle {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background-color: red; /* Domylnie czerwony (nieukoczony) */
    }

    .status-icon.completed .status-circle {
      background-color: green; /* Ukoczony */
    }

    .status-icon.active .status-circle {
      background-color: orange; /* Kolor dla aktywnych plan贸w */
    }
    .plan-panel .status-container {
      margin-top: 10px;
    }

    .plan-panel .status-text {
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 5px;
      color: white;
    }

    .plan-panel .status-text:empty {
      display: none;
    }

    .plan-panel .status-text[th\\:text="'UKOCZONY'"] {
      background-color: green;
    }

    .plan-panel .status-text[th\\:text="'AKTYWNY'"] {
      background-color: orange;
    }
    .status-text {
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 5px;
      color: white;
    }

    .status-text.completed {
      background-color: green; /* To dla statusu UKOCZONY */
    }

    .status-text.active {
      background-color: orange; /* To dla statusu AKTYWNY */
    }
.loading-spinner {
    display: none;
    margin-top: 10px;
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-top: 4px solid #3498db;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}


      </style>
    </head>

    <body>
    <div>
        <input type="text" id="searchInput" placeholder="Szukaj nazwy planu..." onkeyup="filterPlans()">
        <label for="dateFilter">Data rozpoczcia:</label>
        <input type="date" id="dateFilter" onchange="filterPlans()">
        <label for="trainerSelect">Trener:</label>
        <select id="trainerSelect" onchange="filterPlans()">
            <option value="">Wszyscy trenerzy</option>
            <option th:each="trainer : ${trainers}"
                    th:value="${trainer.firstName + ' ' + trainer.secondName}"
                    th:text="${trainer.firstName + ' ' + trainer.secondName}">
            </option>
        </select>
        <select id="sortSelect" onchange="sortPlans()">
            <option value="">Sortuj wedug...</option>
            <option value="name">Sortuj wedug nazwy</option>
            <option value="startDate">Sortuj wedug daty rozpoczcia</option>
            <option value="status">Sortuj wedug statusu</option>
        </select>
        <label>
            <input type="checkbox" id="hideCompletedPlans" onchange="filterPlans()"> Ukryj ukoczone plany
        </label>
        <button onclick="resetFilters()" class="reset-button">Resetuj filtry</button>
    </div>
    <h2>Twoje Plany Treningowe</h2>
    <div class="plans-grid" th:if="${#lists.isEmpty(plans)}">
        <p>Brak dostpnych plan贸w treningowych.</p>
    </div>
    <div class="plans-grid">
        <div class="plan-each" th:each="plan : ${plans}">
            <div class="plan-panel" th:data-plan-id="${plan.idPlan}">
                <h3 class="plan-name" th:text="${plan.name}">Nazwa Planu</h3>
                <p>
                    <strong>Opis:</strong>
                    <span th:text="${plan.description}">Opis planu...</span>
                </p>
                <p>
                    <strong>Data:</strong>
                    <span class="start-date" th:text="${plan.startDate}">Data startu</span>-
                    <span th:text="${plan.endDate}">Data koca</span>
                </p>
                <p>
                    <strong>Trener:</strong>
                    <span class="trainer-name" th:text="${plan.trainer.firstName + ' ' + plan.trainer.secondName}">Imi i Nazwisko</span>
                </p>
                <div class="status-container">
                    <p>
                        <strong>Status:</strong>
                        <span class="status-text"
                              th:classappend="${plan.status == T(com.GoGym.module.TrainingPlan.Status).completed ? 'completed' : 'active'}"
                              th:text="${plan.status == T(com.GoGym.module.TrainingPlan.Status).completed ? 'UKOCZONY' : 'AKTYWNY'}">
             </span>
                    </p>
                </div>
            </div>
            <!-- Modal dla szczeg贸贸w planu -->
            <div class="modal" th:data-plan-id="${plan.idPlan}">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 th:text="'Plan: ' + ${plan.name}">Szczeg贸y Planu</h3>
                        <span class="close-modal">&times;</span>
                    </div>
                    <div class="status-container">
                        <p>
                            <strong>Status planu:</strong>
                            <span id="plan-status" class="status-icon" th:classappend="${plan.status == T(com.GoGym.module.TrainingPlan.Status).completed ? 'completed' : 'active'}">
                  <span class="status-circle">
                  </span>
                </span>
                        </p>
                    </div>
                    <div th:each="day : ${plan.trainingPlanDays}">
                        <div th:data-day-id="${day.idDay}">
                            <h4>
                                <span th:text="${day.dayType == T(com.GoGym.module.TrainingPlanDay.DayType).training ? 'Dzie Treningowy' : 'Regeneracja'}"></span>
                                <span>-</span>
                                <span th:text="${#temporals.format(day.date, 'EEEE dd.MM.yyyy')}"></span>
                            </h4>
                            <div class="status-container">
                                <p>
                                    <strong>Status dnia:</strong>
                                    <span id="day-status" class="status-icon" th:classappend="${day.status == T(com.GoGym.module.TrainingPlanDay.Status).completed ? 'completed' : 'not-completed'}">
                        <span class="status-circle"></span>
                    </span>
                                </p>
                            </div>
                            <p>
                                <strong>Notatki:</strong>
                                <span th:text="${day.notes != null ? day.notes : 'Brak notatek'}">Brak notatek</span>
                            </p>

                            <!-- Przyciski zmiany statusu dla dni odpoczynku -->
                            <div th:if="${day.dayType == T(com.GoGym.module.TrainingPlanDay.DayType).rest}">
                                <button class="toggle-rest-day-status" th:data-day-id="${day.idDay}"
                                        th:text="${day.status == T(com.GoGym.module.TrainingPlanDay.Status).completed
                ? 'Cofnij ukoczenie' : 'Oznacz jako wykonane'}"></button>
                            </div>


                            <ul>
                                <li class="exercise" th:each="exercise : ${day.exercises}">
                                    <span>
                                        <strong th:text="${exercise.exercise.name}"></strong>
                                        <span th:if="${exercise.exercise.type.name() == 'STRENGTH'}">
                                            - <span th:text="${exercise.sets}"></span> serie,
                                            <span th:text="${exercise.reps}"></span> powt贸rze,
                                            <span th:text="${exercise.weight != null ? exercise.weight + ' kg' : 'bez obci偶enia'}"></span>
                                        </span>
                                        <span th:if="${exercise.exercise.type.name() == 'CARDIO'}">
                                            - <span class="exercise-duration"
                                                    th:data-seconds="${exercise.duration}"
                                                    th:text="${exercise.duration}"></span>,
                                            <span th:text="${exercise.distance != null ? exercise.distance + ' km' : 'Brak danych'}"></span>
                                        </span>
                                    </span>

                                    <div class="status-container">
                        <span id="exercise-status" class="status-icon" th:classappend="${exercise.status == T(com.GoGym.module.PlanExercise.Status).completed ? 'completed' : 'not-completed'}">
                            <span class="status-circle"></span>
                        </span>
                                    </div>
                                    <button class="toggle-exercise-status" th:data-exercise-id="${exercise.id}" th:text="${exercise.status.name() == 'completed' ? 'Cofnij ukoczenie' : 'Oznacz jako wykonane'}"></button>
                                    <div class="video-upload-section" th:if="${exercise.videoUrl == null}">
                                        <input type="file" class="video-input" th:data-exercise-id="${exercise.id}" accept="video/*">
                                        <button type="button" class="upload-video-btn">Dodaj film</button>

                                        <input type="text" class="video-link-input" th:data-exercise-id="${exercise.id}" placeholder="Lub wklej link do filmu">
                                        <button type="button" class="add-link-btn">Dodaj link</button>
                                    </div>


                                    <div class="video-status" th:if="${exercise.videoUrl != null}">
                                        <p>
                                            <a th:href="${exercise.videoUrl}" target="_blank" th:text="${exercise.videoUrl.contains('cloudinary.com') ? ' Obejrzyj nagranie' : ' Obejrzyj nagranie'}"></a>
                                        </p>
                                        <button type="button" class="delete-video-btn" th:data-exercise-id="${exercise.id}">Usu nagranie</button>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        function filterPlans() {
            let input = document.getElementById("searchInput").value.toLowerCase();
            let selectedDate = document.getElementById("dateFilter").value;
            let selectedTrainer = document.getElementById("trainerSelect").value.toLowerCase();
            let plans = document.querySelectorAll(".plan-each");
            let hideCompleted = document.getElementById("hideCompletedPlans").checked;
            plans.forEach(plan => {
                let planName = plan.querySelector(".plan-name").innerText.toLowerCase();
                let startDate = plan.querySelector(".start-date").innerText.trim();
                let trainerName = plan.querySelector(".trainer-name").innerText.toLowerCase();
                let statusText = plan.querySelector(".status-text").innerText.toLowerCase();
                let isCompleted = statusText.includes("ukoczony");
                let matchesSearch = planName.includes(input);
                let matchesDate = selectedDate === "" || startDate === selectedDate;
                let matchesTrainer = selectedTrainer === "" || trainerName.includes(selectedTrainer);
                if (matchesSearch && matchesDate && matchesTrainer && (!hideCompleted || !isCompleted)) {
                    plan.style.display = "block";
                } else {
                    plan.style.display = "none";
                }
            });
        }

    function sortPlans() {
        let sortBy = document.getElementById("sortSelect").value;
        let container = document.querySelector(".plans-grid");
        let plans = Array.from(document.querySelectorAll(".plan-each"));

        // Posortowanie plan贸w
        plans.sort((a, b) => {
            if (sortBy === "name") {
                let nameA = a.querySelector(".plan-name").innerText;
                let nameB = b.querySelector(".plan-name").innerText;
                return naturalSort(nameA, nameB);
            } else if (sortBy === "startDate") {
                let dateA = new Date(a.querySelector(".start-date").innerText.trim());
                let dateB = new Date(b.querySelector(".start-date").innerText.trim());
                return dateA - dateB;
            } else if (sortBy === "status") {
                return a.querySelector(".status-text").innerText.localeCompare(b.querySelector(".status-text").innerText);
            }
        });

        // Zresetowanie zawartoci plans-grid
        container.innerHTML = '';

        // Dodanie posortowanych element贸w z powrotem do DOM
        plans.forEach(plan => container.appendChild(plan));
        }

            function naturalSort(a, b) {
            return a.localeCompare(b, undefined, { numeric: true, sensitivity: 'base' });
        }
        let originalPlansOrder = []; // Przechowuje oryginalny ukad plan贸w



        function resetFilters() {
            // Resetuj pole wyszukiwania
            document.getElementById("searchInput").value = "";
            document.getElementById("dateFilter").value = "";
            document.getElementById("sortSelect").value = "";
            document.getElementById("trainerSelect").value = "";
            document.getElementById("hideCompletedPlans").checked = false;
            let container = document.querySelector(".plans-grid");
            container.innerHTML = ""; // Wyczy obecne plany
            originalPlansOrder.forEach(plan => container.appendChild(plan));
            let plans = document.querySelectorAll(".plan-each");
            plans.forEach(plan => plan.style.display = "block");
        }
        document.addEventListener('DOMContentLoaded', function () {
            originalPlansOrder = Array.from(document.querySelectorAll(".plan-each"));
            // Otwieranie modali
            document.querySelectorAll('.plan-panel').forEach(panel => {
                panel.addEventListener('click', () => {
                    // Sprawdza, czy kliknity element jest przyciskiem lub linkiem
                    if (event.target.closest("button") || event.target.closest("a")) {
                        return; // Jeli kliknito przycisk lub link, nie otwieramy modala
                    }
                    const planId = panel.getAttribute('data-plan-id');
                    const modal = document.querySelector(`.modal[data-plan-id="${planId}"]`);
                    modal.style.display = 'flex';
                });
            });

            // Obsuga zamykania modali: kliknicie na X, kliknicie poza modalem, ESC
            document.addEventListener('click', (event) => {
                const modal = event.target.closest('.modal'); // Sprawdza, czy kliknito modal
                if (
                    event.target.classList.contains('close-modal') || // Kliknicie w X
                    (modal && event.target === modal) // Kliknicie poza zawartoci modala
                ) {
                    closeModal(modal);
                }
            });

            // Zamykanie modali po naciniciu ESC
            document.addEventListener('keydown', (event) => {
                if (event.key === "Escape") {
                    document.querySelectorAll('.modal').forEach(closeModal);
                }
            });

            function closeModal(modal) {
                if (modal) modal.style.display = 'none';
            }


            // Obsuga kliknicia w przycisk zmiany statusu wiczenia lub dnia odpoczynku
            document.addEventListener('click', function (event) {
                // Sprawd藕, czy kliknito przycisk zmiany statusu wiczenia
                if (event.target.matches('.toggle-exercise-status')) {
                    const exerciseId = event.target.getAttribute('data-exercise-id');
                    const button = event.target;
                    const currentStatus = button.textContent.includes('Cofnij ukoczenie') ? false : true;

                    fetch(`/update-exercise-status/${exerciseId}?completed=${currentStatus}`, { method: 'POST' })
                        .then(response => {
                            if (!response.ok) throw new Error('Nie udao si zaktualizowa statusu wiczenia.');
                            return response.text();
                        })
                        .then(() => {
                            button.textContent = currentStatus ? 'Cofnij ukoczenie' : 'Oznacz jako wykonane';
                            const statusContainer = button.closest('.exercise').querySelector('.status-icon');
                            if (statusContainer) {
                                statusContainer.classList.toggle('completed', currentStatus);
                                statusContainer.classList.toggle('not-completed', !currentStatus);
                            }

                            const dayElement = button.closest('[data-day-id]');
                            if (!dayElement) {
                                console.error('Nie znaleziono elementu dnia.');
                                return;
                            }

                            const dayId = dayElement.getAttribute('data-day-id');
                            return fetch(`/update-day-status/${dayId}`, { method: 'POST' });
                        })
                        .then(response => {
                            if (!response.ok) throw new Error('Nie udao si zaktualizowa statusu dnia.');
                            return response.json();
                        })
                        .then(data => {
                            const dayStatusElement = document.querySelector(`[data-day-id="${data.dayId}"] .status-icon`);
                            if (dayStatusElement) {
                                dayStatusElement.classList.toggle('completed', data.status === 'completed');
                                dayStatusElement.classList.toggle('not-completed', data.status !== 'completed');
                            }

                            // Aktualizacja statusu planu po ka偶dej zmianie statusu dnia
                            const planId = event.target.closest('.modal').getAttribute('data-plan-id');
                            return fetch(`/update-plan-status/${planId}`, { method: 'POST' });
                        })
                        .then(response => {
                            if (!response.ok) throw new Error('Nie udao si zaktualizowa statusu planu.');
                            return response.json();
                        })
                        .then(data => {
                            const planStatusElement = document.querySelector(`.modal[data-plan-id="${data.planId}"] #plan-status`);
                            if (planStatusElement) {
                                planStatusElement.classList.toggle('completed', data.status === 'completed');
                                planStatusElement.classList.toggle('active', data.status !== 'completed');
                            }

                            const planId = data.planId;

                            // Aktualizacja statusu na kafelku planu
                            const planPanel = document.querySelector(`.plan-panel[data-plan-id="${planId}"] .status-text`);
                            if (planPanel) {
                                const isCompleted = data.status === 'completed';
                                planPanel.textContent = isCompleted ? 'UKOCZONY' : 'AKTYWNY';
                                planPanel.classList.remove('completed', 'active');
                                planPanel.classList.add(isCompleted ? 'completed' : 'active');
                                planPanel.style.backgroundColor = data.status === 'completed' ? 'green' : 'orange';
                            }
                        })
                        .catch(error => console.error('Bd:', error));
                }

                // Sprawd藕, czy kliknito przycisk zmiany statusu dnia odpoczynku
    // Obsuga kliknicia w przycisk zmiany statusu dnia odpoczynku
    if (event.target.matches('.toggle-rest-day-status')) {
        const dayId = event.target.getAttribute('data-day-id');
        const button = event.target;
        const currentStatus = button.textContent.includes('Cofnij ukoczenie') ? false : true;

        fetch(`/update-rest-day-status/${dayId}`, { method: 'POST' })
            .then(response => {
                if (!response.ok) throw new Error('Nie udao si zaktualizowa statusu dnia odpoczynku.');
                return response.json();
            })
            .then(data => {
                // Aktualizacja tekstu przycisku
                button.textContent = currentStatus ? 'Cofnij ukoczenie' : 'Oznacz jako wykonane';

                // Znalezienie kontenera statusu dla dnia regeneracyjnego
                const dayElement = document.querySelector(`[data-day-id="${data.dayId}"]`);
                if (!dayElement) {
                    console.error(`Nie znaleziono elementu dnia o ID: ${data.dayId}`);
                    return;
                }

                const statusContainer = dayElement.querySelector('.status-icon');
                if (statusContainer) {
                    // Zmiana klasy statusu
                    statusContainer.classList.toggle('completed', currentStatus);
                    statusContainer.classList.toggle('not-completed', !currentStatus);
                }

                // Aktualizacja statusu planu
                const planId = button.closest('.modal').getAttribute('data-plan-id');
                return fetch(`/update-plan-status/${planId}`, { method: 'POST' });
            })
            .then(response => {
                if (!response.ok) throw new Error('Nie udao si zaktualizowa statusu planu.');
                return response.json();
            })
            .then(data => {
                // Aktualizacja statusu planu w modal i na kafelku
                const planStatusElement = document.querySelector(`.modal[data-plan-id="${data.planId}"] #plan-status`);
                if (planStatusElement) {
                    planStatusElement.classList.toggle('completed', data.status === 'completed');
                    planStatusElement.classList.toggle('active', data.status !== 'completed');
                }

                const planPanel = document.querySelector(`.plan-panel[data-plan-id="${data.planId}"] .status-text`);
                if (planPanel) {
                    const isCompleted = data.status === 'completed';
                    planPanel.textContent = isCompleted ? 'UKOCZONY' : 'AKTYWNY';
                    planPanel.classList.remove('completed', 'active');
                    planPanel.classList.add(isCompleted ? 'completed' : 'active');
                    planPanel.style.backgroundColor = isCompleted ? 'green' : 'orange';
                }
            })
            .catch(error => console.error('Bd:', error));
    }

            });
        });
            function formatDuration(seconds) {
            if (isNaN(seconds) || seconds === null) return "Brak danych";
            let hours = Math.floor(seconds / 3600);
            let minutes = Math.floor((seconds % 3600) / 60);
            let remainingSeconds = seconds % 60;
            return hours > 0
                ? `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`
                : `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
        }

        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".exercise-duration").forEach(el => {
                let seconds = parseInt(el.getAttribute("data-seconds"), 10);
                el.textContent = formatDuration(seconds);
            });
        });


document.addEventListener("DOMContentLoaded", function () {
    function attachUploadEvents() {
        document.querySelectorAll(".upload-video-btn").forEach(button => {
            button.onclick = function () {
                let exerciseId = this.previousElementSibling.getAttribute("data-exercise-id");
                let fileInput = this.previousElementSibling;
                let file = fileInput.files[0];

                if (!file) {
                    alert("Prosz wybra plik wideo.");
                    return;
                }

                if (file.size > 100 * 1024 * 1024) { // 100MB limit
                    alert("Plik jest za du偶y! Maksymalny rozmiar to 100MB. Mo偶esz doda link do wideo zamiast przesya plik.");
                    return;
                }

                showLoadingSpinner(exerciseId);

                let formData = new FormData();
                formData.append("file", file);

                fetch(`/video/upload/${exerciseId}`, { method: "POST", body: formData })
                    .then(response => response.text())
                    .then(videoUrl => {
                        replaceWithVideo(exerciseId, videoUrl, "cloudinary");
                    })
                    .catch(error => console.error("Bd:", error))
                    .finally(() => setTimeout(() => hideLoadingSpinner(exerciseId), 50)); //  Dodane op贸藕nienie
            };
        });

        document.querySelectorAll(".add-link-btn").forEach(button => {
            button.onclick = function () {
                let exerciseId = this.previousElementSibling.getAttribute("data-exercise-id");
                let linkInput = this.previousElementSibling;
                let link = linkInput.value.trim();

                if (!link) {
                    alert("Prosz wpisa link do wideo.");
                    return;
                }

                showLoadingSpinner(exerciseId);

                fetch(`/video/link/${exerciseId}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/x-www-form-urlencoded" },
                    body: "link=" + encodeURIComponent(link)
                })
                .then(response => response.text())
                .then(videoUrl => {
                    replaceWithVideo(exerciseId, videoUrl, "link");
                })
                .catch(error => console.error("Bd:", error))
                .finally(() => setTimeout(() => hideLoadingSpinner(exerciseId), 50));
            };
        });
    }

    function attachDeleteEvents() {
        document.querySelectorAll(".delete-video-btn").forEach(button => {
            button.onclick = function () {
                let exerciseId = this.getAttribute("data-exercise-id");

                showLoadingSpinner(exerciseId);

                fetch(`/video/delete/${exerciseId}`, { method: "DELETE" })
                    .then(response => response.text())
                    .then(() => {
                        restoreUploadSection(exerciseId);
                    })
                    .catch(error => console.error("Bd:", error))
                    .finally(() => setTimeout(() => hideLoadingSpinner(exerciseId), 50));
            };
        });
    }

    function replaceWithVideo(exerciseId, videoUrl, type) {
        let exerciseElement = document.querySelector(`.exercise [data-exercise-id="${exerciseId}"]`).closest(".exercise");

        let videoSection = exerciseElement.querySelector(".video-upload-section");
        if (videoSection) {
            videoSection.remove();
        }

        let oldVideoStatus = exerciseElement.querySelector(".video-status");
        if (oldVideoStatus) {
            oldVideoStatus.remove();
        }

        let videoStatusDiv = document.createElement("div");
        videoStatusDiv.classList.add("video-status");
        videoStatusDiv.innerHTML = `
            <p><a href="${videoUrl}" target="_blank">${type === "cloudinary" ? " Obejrzyj nagranie" : " Obejrzyj na YouTube"}</a></p>
            <button type="button" class="delete-video-btn" data-exercise-id="${exerciseId}">Usu nagranie</button>
        `;
        exerciseElement.appendChild(videoStatusDiv);

        attachDeleteEvents();
    }

    function restoreUploadSection(exerciseId) {
        let exerciseElement = document.querySelector(`.exercise [data-exercise-id="${exerciseId}"]`).closest(".exercise");

        let oldVideoStatus = exerciseElement.querySelector(".video-status");
        if (oldVideoStatus) {
            oldVideoStatus.remove();
        }

        let videoUploadHtml = `
            <div class="video-upload-section">
                <input type="file" class="video-input" data-exercise-id="${exerciseId}" accept="video/*">
                <button type="button" class="upload-video-btn">Dodaj film</button>

                <input type="text" class="video-link-input" data-exercise-id="${exerciseId}" placeholder="Lub wklej link do filmu">
                <button type="button" class="add-link-btn">Dodaj link</button>
            </div>
            <div class="loading-spinner" id="spinner-${exerciseId}"></div>
        `;
        exerciseElement.insertAdjacentHTML("beforeend", videoUploadHtml);

        attachUploadEvents();
    }

    function showLoadingSpinner(exerciseId) {
        let exerciseElement = document.querySelector(`.exercise [data-exercise-id="${exerciseId}"]`).closest(".exercise");

        let spinner = exerciseElement.querySelector(".loading-spinner");
        if (!spinner) {
            spinner = document.createElement("div");
            spinner.classList.add("loading-spinner");
            spinner.setAttribute("id", `spinner-${exerciseId}`);
            exerciseElement.appendChild(spinner);
        }
        spinner.style.display = "block";
    }

    function hideLoadingSpinner(exerciseId) {
        let spinner = document.getElementById(`spinner-${exerciseId}`);
        if (spinner) {
            spinner.style.display = "none";
            spinner.remove(); //  Dodatkowo usuwamy element, 偶eby unikn zduplikowania
        }
    }

    attachUploadEvents();
    attachDeleteEvents();
});



    </script>

    </body>

    </html>